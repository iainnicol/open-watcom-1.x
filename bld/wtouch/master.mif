proj_name = wtouch

!include cproj.mif
!include deftarg.mif
!include defrule.mif

!include wres.mif

.EXTENSIONS: .msg .vi .rc .sp

inc_dirs = $(wtouch_dir)#;$(wtouch_dir)\$(host_os)$(host_cpu)

.c .msg .vi .rc .sp: $(wtouch_dir)

objs =               &
        touch.obj    &
        dtparse.obj  &
        wtmsg.obj

dependants = wtouch.res $(objs)

$(proj_name).exe : $(dependants)
        $(linker) option quiet $(lflags) name $^@ file { $(objs) } lib $(wres_lib)
        wstrip -q -a -r $(proj_name).exe . $(proj_name).res

$(proj_name).res : $(proj_name).rc $(proj_name).msg usage.rc usagej.rc msg.gh
        $(rc_aui) -i"$(wtouch_dir)" $[@ -fo=$^@

usage.rc : usage.sp
        wsplice -kIS_RC -kENGLISH -t8 -f "%+(MSG_USE_E_BASE+%$#-1), \"%s\"" $[@ usage.rc

usagej.rc : usage.sp
        wsplice -kIS_RC -kJAPANESE -t8 -f "%+(MSG_USE_J_BASE+%$#-1), \"%s\"" $[@  usagej.rc

msg.gh : $(proj_name).msg msg.vi
        $(vi) -s $]@ $[@
