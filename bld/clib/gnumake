include $(DEVDIR)/build/mif/master.mk

all: $(OBJDIR)/libwatcom.a

SRCDIRS = convert/c misc/c string/c memory/c handleio/c startup/c environ/c mbyte/c

vpath %.c $(SRCDIRS)

OBJECTS =
OBJECTS += itoa.o ltoa.o alphabet.o splitpat.o split2.o makepath.o fullpath.o 
OBJECTS += strlwr.o memicmp.o tell.o rotl.o seterrno.o strupr.o strnset.o
OBJECTS += strrev.o filelen.o eof.o cmdname.o gtcmdunx.o searchen.o wrlang.o

OBJECTS := $(foreach i,$(OBJECTS),$(OBJDIR)/$i)

LIBNAME=watcom

DEFS += -D_COMDEF_H_INCLUDED -D__WATCOM_INT64__ -D__int64="long long" -D_RWD_errno=errno
INCDIRS = h $(WATCOMH) $(LIB_MISC_DIR)/h

$(OBJDIR)/lib$(LIBNAME).a: $(OBJDIR) $(OBJECTS)
	@rm -f $@
	$(AR) crs $@ $(OBJECTS)

$(OBJDIR):
	mkdir $(OBJDIR)

clean:
	rm -rf $(OBJDIR)
