proj_name = aui

.ERASE

!ifndef aui_autodepends
aui_autodepends = .AUTODEPEND
!endif

suppress_zc = 1

!include cproj.mif
!include defrule.mif
!include deftarg.mif

.EXTENSIONS: .dlg .rc

inc_dirs = $(lang_root)/h;$(aui_dir)/h;$(gui_dir)/h;$(posix_dir)/h

.c: .;$(aui_dir)/c;$(posix_dir)/misc
.h: .;$(aui_dir)/h

extra_c_flags += -s

extra_c_flags_i86 = -fpc -zc
extra_c_flags_386 = -fpc

extra_c_flags_nov = -4s -dNLM -ot
!ifeq host_CPU i86
extra_c_flags_win = -zW
extra_c_flags_dos = -of
!ifdef pm
extra_c_flags_os2 = -zu
!endif
!else
extra_c_flags_win = -zw
!endif

extra_c_flags_regexp = -fi=wndregx.h

!ifdef pm
dlgs = dlgrx.dlg dlgsrch.dlg dlgsrcha.dlg &
       japrx.dlg japsrch.dlg japsrcha.dlg
!endif

all : auistr.gh aui.lib $(dlgs) .SYMBOLIC
        @%null

eraseall.obj : $(aui_dir)/compile.gbl
        rm -f *.obj
        wtouch eraseall.obj

objs =  guimain.obj &
        wndgadgt.obj &
        wndrect.obj &
        wndtbatr.obj &
        wndbgch.obj &
        wndstyle.obj &
        wndhist.obj &
        wndhelp.obj &
        wndstat.obj &
        wndchoos.obj &
        wndcreat.obj &
        wndcrsr.obj &
        wndcurr.obj &
        wndid.obj &
        wndmem.obj &
        wndmeth.obj &
        wndutil.obj &
        wndchar.obj &
        wndpop.obj &
        regexp.obj &
        wndscrol.obj &
        wndsel.obj &
        wndsrch.obj &
        wndfdlg.obj &
        wnddlg.obj &
        dlgsrch.obj &
        dlgpick.obj &
        dlgnew.obj &
        wndspawn.obj &
        wndalloc.obj &
        wndshrnk.obj &
        wndtool.obj &
        wnddoin.obj &
        wndresiz.obj &
        wndsysin.obj &
        wndclean.obj &
        wndmacro.obj &
        wndring.obj &
        wndefra.obj &
        wndfonhk.obj &
        wndshthk.obj &
        wndqryhk.obj &
        wndendhk.obj &
        wndrszhk.obj &
        wndsfra.obj &
        wndfont.obj &
        wndldstr.obj &
        wndfront.obj &
        wndpaint.obj &
        wnddirt.obj &
        wnddfclr.obj &
        wndcolor.obj &
        wndmouse.obj &
        wndrxerr.obj &
        wndfref.obj &
        wndmsg.obj &
        wndmnsz.obj &
        wndimain.obj

aui.lib : $(objs) $(__makefiles__) $(aui_dir)/h/aui.rc
        @%create tmp.lbc
        @for %i in ($(objs)) do @%append tmp.lbc +%i
        $(librarian) -b -n $^@ @tmp.lbc
        @rm -f tmp.lbc

.rc: ../h
!ifdef pm
dlgrx.dlg : ../h/dlgrx.dlg
    parsedlg -font $[@ dlgrx.dlg

dlgsrch.dlg : ../h/dlgsrch.dlg
    parsedlg -font $[@ dlgsrch.dlg

dlgsrcha.dlg : ../h/dlgsrcha.dlg
    parsedlg -font $[@ dlgsrcha.dlg

japrx.dlg : ../h/japrx.dlg
    parsedlg -font $[@ japrx.dlg

japsrch.dlg : ../h/japsrch.dlg
    parsedlg -font $[@ japsrch.dlg

japsrcha.dlg : ../h/japsrcha.dlg
    parsedlg -font $[@ japsrcha.dlg
!else
.dlg : ../h
!endif

dlgfiles = dlgrx.h dlgsrch.h dlgrx.dlg dlgsrch.dlg dlgsrcha.dlg auistr.gh auistr.rc auigui.rc

./mkstr.exe: $(aui_dir)/c/mkstr.c
        $(bld_cl) $(wcl_util_opts) $]@

auistr.gh : ./mkstr.exe $(aui_dir)/h/aui.msg
        $[@ $^@
